<!-- app/templates/dashboard.html -->
{% extends "base.html" %}

{% block content %}
<div class="dashboard-container">
    <div class="container">
        <h1>Dashboard</h1>
        <div class="dashboard-grid">
            <div class="dashboard-card">
                <h3>Recent Analyses</h3>
                <div id="recent-analyses">
                    <p>No recent analyses found. <a href="/">Start your first analysis</a></p>
                </div>
            </div>
            
            <div class="dashboard-card">
                <h3>Quick Stats</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-number" id="total-analyses">0</span>
                        <span class="stat-label">Total Analyses</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="high-confidence">0</span>
                        <span class="stat-label">High Confidence Results</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.dashboard-container {
    padding: 2rem;
    background: white;
    margin: 2rem;
    border-radius: 12px;
    box-shadow: var(--shadow);
}

.dashboard-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    margin-top: 2rem;
}

.dashboard-card {
    background: var(--light-color);
    padding: 2rem;
    border-radius: 12px;
    border: 1px solid var(--border-color);
}

.dashboard-card h3 {
    color: var(--primary-color);
    margin-bottom: 1rem;
    font-size: 1.3rem;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
}

.stat-item {
    text-align: center;
    padding: 1rem;
    background: white;
    border-radius: 8px;
    border: 1px solid var(--border-color);
}

.stat-number {
    display: block;
    font-size: 2rem;
    font-weight: 700;
    color: var(--primary-color);
}

.stat-label {
    font-size: 0.9rem;
    color: var(--text-color);
    opacity: 0.7;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    loadDashboardData();
});

function loadDashboardData() {
    const savedAnalyses = JSON.parse(localStorage.getItem('savedAnalyses') || '[]');
    
    // Update stats
    document.getElementById('total-analyses').textContent = savedAnalyses.length;
    
    // Load recent analyses
    const recentContainer = document.getElementById('recent-analyses');
    if (savedAnalyses.length > 0) {
        const recentHtml = savedAnalyses.slice(-5).reverse().map(analysis => `
            <div class="recent-analysis-item">
                <strong>${analysis.location}</strong>
                <span class="analysis-date">${new Date(analysis.timestamp).toLocaleDateString()}</span>
                <button onclick="loadAnalysisDetails('${analysis.id}')" class="btn btn-secondary btn-sm">View</button>
            </div>
        `).join('');
        recentContainer.innerHTML = recentHtml;
    }
}
</script>
{% endblock %}